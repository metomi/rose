#!/usr/bin/env bash
#-------------------------------------------------------------------------------
# (C) British Crown Copyright 2012-3 Met Office.
# 
# This file is part of Rose, a framework for scientific suites.
# 
# Rose is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
# 
# Rose is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
# 
# You should have received a copy of the GNU General Public License
# along with Rose. If not, see <http://www.gnu.org/licenses/>.
#-------------------------------------------------------------------------------
# NAME
#     rose ana
#
# SYNOPSIS
#     rose ana [--method-path=/path/to/comparisons] FILENAMES
#
# DESCRIPTION
#     Run the given test config files through the comparison engine.
#
# OPTIONS
#     --method-path=DIR, -p DIR
#         Specify additional directories to locate extraction and comparison
#         classes.
#
# CONFIGURATION FILE CONTENTS
#
#     A human-readable name of the test should be placed in square brackets,
#     followed by the following settings, one per line:
#
#     comparison
#         The class name which will be called to compare the resulting data from
#         the 'extract' command.
#     extract
#         Either the class name which should be called to extract data from the
#         files to be compared, or a system command which will be called to
#         extract or compare the files. In the latter case, the tokens 
#         {resultfile} and {kgo1file} map to the values defined in the 
#         configuration file. The token {file} will result in the command being
#         called twice, once on {resultfile} and once on {kgo1file}. Some
#         extraction classes such as 'OutputGrepper' require additional 
#         information about how to extract the data. This should be placed
#         after the class name, separated from it by a colon.
#     kgo1file
#         The path and name of the file containing the known good output.
#         Environment variables and the wildcard character '*' are accepted.
#     resultfile
#         The path and name of the file containing the output to be compared.
#         Environment variables and the wildcard character '*' are accepted.
#     tolerance
#         For inexact comparisons such as 'Within', the tolerance should be 
#         specified using this variable. Values with a percentage sign are 
#         treated as percentages, otherwise values are treated as a range
#         either side of the known good output value. This value is optional;
#         some comparisons such as 'Exact' do not require it.
#     warnonfail
#         If this is set to be 'yes' a failure of the test will result in a
#         warning rather than a failure. This value is always optional.
#
# CONFIGURATION FILE EXAMPLE
#
#     [Compare initial norms]
#     resultfile = $OUTPUT_DIR/fort6.pe0
#     kgo1file = /path/to/kgo/fort6.pe0
#     extract = OutputGrepper:um_initial_norms
#     comparison = Within
#     tolerance = 5%
#
#-------------------------------------------------------------------------------
exec python -m rose.ana "$@"
