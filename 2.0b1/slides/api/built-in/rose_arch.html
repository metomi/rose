

<!DOCTYPE html>


<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>rose_arch &mdash; Rose Documentation 2.0b1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/styles.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/single.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <link rel="stylesheet" href="../../_static/css/slides-custom.css" type="text/css" />
    
    
    
    <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/diff_selector.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/grid_table.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/hieroglyph_theme_addons.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/tutorial.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/addons.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.0b1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/diff_selector.js"></script>
    <script type="text/javascript" src="../../_static/js/minicylc.js"></script>
    <script type="text/javascript" src="../../_static/js/spoiler.js"></script>
    <script type="text/javascript" src="../../_static/js/addons.js"></script>
    <script type="text/javascript" src="../../_static/js/versioning.js"></script>
    <script type="text/javascript" src="../../_static/common.js"></script>
    
    <script type="text/javascript" src="../../_static/slides.js"></script>
    <script type="text/javascript" src="../../_static/sync.js"></script>
    <script type="text/javascript" src="../../_static/controller.js"></script>
    <script type="text/javascript" src="../../_static/init.js"></script>
    
    
    <link rel="shortcut icon" href="../../_static/rose-favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="top" title="Rose Documentation 2.0b1 documentation" href="../../index.html" />
    <link rel="up" title="Rose Built-In Applications" href="../rose-built-in-applications.html" />
    <link rel="next" title="rose_bunch" href="rose_bunch.html" />
    <link rel="prev" title="rose_ana" href="rose_ana.html" /> 
  </head>
  <body>

<section
   id="slide_container"
   class='slides layout-regular'>


  
<article class="slide level-1" id="rose-arch">

<h1><code class="docutils literal notranslate"><span class="pre">rose_arch</span></code><a class="headerlink" href="../../../html/api/built-in/rose_arch.html#rose-arch" title="View HTML">§</a></h1>

<p>This built-in application provides a generic solution to configure
site-specific archiving of suite files for use with
<a class="reference internal" href="../command-reference.html#command-rose-task-run"><span class="std std-ref">rose task-run</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="#rose:app:rose_arch" title="rose:app:rose_arch"><code class="xref rose rose-app docutils literal notranslate"><span class="pre">rose_arch</span></code></a> is designed to work with suite files so runs under
<a class="reference internal" href="../command-reference.html#command-rose-task-run"><span class="std std-ref">rose task-run</span></a>. It cannot run under
<a class="reference internal" href="../command-reference.html#command-rose-app-run"><span class="std std-ref">rose app-run</span></a>.</p>
</div>
<p>The application is normally configured in a <a class="reference internal" href="../configuration/application.html#rose:file:rose-app.conf" title="rose:file:rose-app.conf"><code class="xref rose rose-file docutils literal notranslate"><span class="pre">rose-app.conf</span></code></a>. Global
settings may be specified in an <a class="reference internal" href="#rose:conf:rose_arch[arch]" title="rose:conf:rose_arch[arch]"><code class="xref rose rose-conf docutils literal notranslate"><span class="pre">rose_arch[arch]</span></code></a>
section. Each archiving target will have its own <code class="docutils literal notranslate"><span class="pre">[arch:TARGET]</span></code>
section for specific settings, where <code class="docutils literal notranslate"><span class="pre">TARGET</span></code> would be a URI to
the archiving location on your site-specific archiving system. Settings
in a <code class="docutils literal notranslate"><span class="pre">[arch:TARGET]</span></code> section would override those in the global
<a class="reference internal" href="#rose:conf:rose_arch[arch]" title="rose:conf:rose_arch[arch]"><code class="xref rose rose-conf docutils literal notranslate"><span class="pre">rose_arch[arch]</span></code></a> section for the given <code class="docutils literal notranslate"><span class="pre">TARGET</span></code>.</p>
<p>A target is considered compulsory, i.e. it must have at least one
source, unless it is specified with the syntax <code class="docutils literal notranslate"><span class="pre">[arch:(TARGET)]</span></code>.
In which case, <code class="docutils literal notranslate"><span class="pre">TARGET</span></code> is considered optional. The application will
skip an optional target that has no actual source.</p>
<p>The application provides some useful functionalities:</p>
<ul class="simple">
<li>Incremental mode: store the archive target settings, checksums of
source files and the return code of archive command. In a retry, it
would only redo targets that did not succeed in the previous attempts.</li>
<li>Rename source files.</li>
<li>Tar-Gzip or Gzip source files before sending them to the archive.</li>
</ul>




</article>
<article class="slide level-2" id="invocation">

<h2>Invocation<a class="headerlink" href="../../../html/api/built-in/rose_arch.html#invocation" title="View HTML">§</a></h2>

<p>In automatic selection mode, this built-in application will be invoked
automatically if a task has a name that starts with <code class="docutils literal notranslate"><span class="pre">rose_arch*</span></code>.</p>
<p>This means that you can use Rose Arch with something like the example below
in your <code class="docutils literal notranslate"><span class="pre">flow.cylc</span></code>:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
   <span class="c1"># ...</span>
   <span class="nt">[[dependencies]]</span>
       <span class="nv">P1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">       all =&gt; the =&gt; tasks =&gt; rose_arch_archive</span>
<span class="s2">       &quot;&quot;&quot;</span>

<span class="nt">[runtime]</span>
   <span class="c1"># ...</span>

   <span class="nt">[[rose_arch_archive]]</span>
</pre></div>
</div>




</article>
<article class="slide level-2" id="examples">

<h2>Examples<a class="headerlink" href="../../../html/api/built-in/rose_arch.html#examples" title="View HTML">§</a></h2>

<p>The following examples all form part of a single <a class="reference internal" href="../configuration/application.html#rose:file:rose-app.conf" title="rose:file:rose-app.conf"><code class="xref rose rose-file docutils literal notranslate"><span class="pre">rose-app.conf</span></code></a> file:</p>




</article>
<article class="slide level-3" id="general-settings">

<h3>General Settings<a class="headerlink" href="../../../html/api/built-in/rose_arch.html#general-settings" title="View HTML">§</a></h3>

<p>These settings are placed here to be inherited by other archive tasks in the
file: In this case we’ve set <code class="docutils literal notranslate"><span class="pre">command</span> <span class="pre">format</span></code> which sets how we are going
to copy the files to the archive location.
We’ve also set prefixes for the source and target locations, so that we
don’t have repeatedly specify common locations.</p>
<div class="highlight-rose notranslate"><div class="highlight"><pre><span></span><span class="c1"># General settings</span>
<span class="nt">[arch]</span>
<span class="nv">command-format</span><span class="o">=</span><span class="s">foo put %(sources)s %(target)s</span>
<span class="nv">source-prefix</span><span class="o">=</span><span class="s">$ROSE_DATAC/</span>
<span class="nv">target-prefix</span><span class="o">=</span><span class="s">foo://hello/</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="archive-a-file-to-a-file">

<h3>Archive a file to a file<a class="headerlink" href="../../../html/api/built-in/rose_arch.html#archive-a-file-to-a-file" title="View HTML">§</a></h3>

<p>In this simplest use case rose arch is just moving a single file to another
location.</p>
<div class="highlight-rose notranslate"><div class="highlight"><pre><span></span><span class="c1"># Archive a file to a file</span>
<span class="nt">[arch:world.out]</span>
<span class="nv">source</span><span class="o">=</span><span class="s">hello/world.out</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="archiving-directories">

<h3>Archiving directories<a class="headerlink" href="../../../html/api/built-in/rose_arch.html#archiving-directories" title="View HTML">§</a></h3>

<p>You can archive files matched by one or more glob expressions to a directory:</p>
<div class="highlight-rose notranslate"><div class="highlight"><pre><span></span><span class="c1"># A single glob</span>
<span class="nt">[arch:worlds/]</span>
<span class="nv">source</span><span class="o">=</span><span class="s">hello/worlds/*</span>

<span class="c1"># Three globs</span>
<span class="nt">[arch:worlds/]</span>
<span class="nv">source</span><span class="o">=</span><span class="s">hello/worlds/* greeting/worlds/* hi/worlds/*</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="missing-files-and-directories">

<h3>Missing files and directories<a class="headerlink" href="../../../html/api/built-in/rose_arch.html#missing-files-and-directories" title="View HTML">§</a></h3>

<p>It’s also possibly to deal with a situation where one or more of the source
expressions might not return anything by putting brackets - <code class="docutils literal notranslate"><span class="pre">()</span></code> - around it:</p>
<div class="highlight-rose notranslate"><div class="highlight"><pre><span></span><span class="c1"># If there isn&#39;t anything in greeting/worlds/ Rose Arch continues</span>
<span class="nt">[arch:worlds/]</span>
<span class="nv">source</span><span class="o">=</span><span class="s">hello/worlds/* (greeting/worlds/*) hi/worlds/*</span>
</pre></div>
</div>
<p>You can even tell Rose Arch that there may be nothing to archive, but to carry
on:</p>
<div class="highlight-rose notranslate"><div class="highlight"><pre><span></span><span class="nt">[arch:(black-box/)]</span>
<span class="nv">source</span><span class="o">=</span><span class="s">cats.txt dogs.txt</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="zipping-files">

<h3>Zipping files<a class="headerlink" href="../../../html/api/built-in/rose_arch.html#zipping-files" title="View HTML">§</a></h3>

<p>There are multiple ways of specifying that you want your archive to be
compressed:</p>
<p>You can infer compression from the target extension:</p>
<div class="highlight-rose notranslate"><div class="highlight"><pre><span></span><span class="nt">[arch:planet.gz]</span>
<span class="nv">source</span><span class="o">=</span><span class="s">hello/planet.out</span>
</pre></div>
</div>
<p>or manually specify a compression program. (In this case the <code class="docutils literal notranslate"><span class="pre">out.gz</span></code> is
not recognized by rose arch as an extension to be compressed.)</p>
<div class="highlight-rose notranslate"><div class="highlight"><pre><span></span><span class="nt">[arch:planet.out.gz]</span>
<span class="nv">compress</span><span class="o">=</span><span class="s">gz</span>
<span class="nv">source</span><span class="o">=</span><span class="s">hello/planet.out</span>
</pre></div>
</div>
<p>For more details see <a class="reference internal" href="#rose:conf:rose_arch[arch]compress" title="rose:conf:rose_arch[arch]compress"><code class="xref rose rose-conf docutils literal notranslate"><span class="pre">rose_arch[arch]compress</span></code></a></p>




</article>
<article class="slide level-3" id="zipping-directories">

<h3>Zipping directories<a class="headerlink" href="../../../html/api/built-in/rose_arch.html#zipping-directories" title="View HTML">§</a></h3>

<p>You can tar and zip entire directories - as with single files Rose Arch will
attempt to infer archive and compression from <code class="docutils literal notranslate"><span class="pre">[arch:TARGET.extension]</span></code> if it
can:</p>
<div class="highlight-rose notranslate"><div class="highlight"><pre><span></span><span class="nt">[arch:galaxies.tar.gz]</span>
<span class="nv">source-prefix</span><span class="o">=</span><span class="s">hello/</span>
<span class="nv">source</span><span class="o">=</span><span class="s">galaxies/*</span>
<span class="c1"># File with multiple galaxies may be large, don&#39;t do its checksum</span>
<span class="nv">update-check</span><span class="o">=</span><span class="s">mtime+size</span>
</pre></div>
</div>
<p>You might prefer to explicitly gzip each file in the source directory separately:</p>
<div class="highlight-rose notranslate"><div class="highlight"><pre><span></span><span class="c1"># Force gzip each source file</span>
<span class="nt">[arch:stars/]</span>
<span class="nv">source</span><span class="o">=</span><span class="s">stars/*</span>
<span class="nv">compress</span><span class="o">=</span><span class="s">gzip</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="renaming-files-simply">

<h3>Renaming files simply<a class="headerlink" href="../../../html/api/built-in/rose_arch.html#renaming-files-simply" title="View HTML">§</a></h3>

<p>You may wish to change the name of the archived files. By default the contents
of your app’a <a class="reference internal" href="#rose:conf:rose_arch[arch]source" title="rose:conf:rose_arch[arch]source"><code class="xref rose rose-conf docutils literal notranslate"><span class="pre">rose_arch[arch]source</span></code></a> and
<code class="docutils literal notranslate"><span class="pre">$CYLC_TASK_CYCLE_TIME</span></code> are available to you as python formatting strings
<code class="docutils literal notranslate"><span class="pre">%(name)s</span></code> and <code class="docutils literal notranslate"><span class="pre">%(cycle)s</span></code>.</p>
<div class="highlight-rose notranslate"><div class="highlight"><pre><span></span><span class="nt">[arch:moons.tar.gz]</span>
<span class="nv">source</span><span class="o">=</span><span class="s">moons/*</span>
<span class="nv">rename-format</span><span class="o">=</span><span class="s">%(cycle)s-%(name)s</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">As <code class="docutils literal notranslate"><span class="pre">%(name)s</span></code> can be a path is may not always make sense to
prepend <code class="docutils literal notranslate"><span class="pre">%(cycle)s</span></code> to it - consider <code class="docutils literal notranslate"><span class="pre">01_/absolute/path/to/datafile</span></code></p>
</div>




</article>
<article class="slide level-3" id="renaming-using-a-rename-parser">

<h3>Renaming using a <code class="docutils literal notranslate"><span class="pre">rename-parser</span></code><a class="headerlink" href="../../../html/api/built-in/rose_arch.html#renaming-using-a-rename-parser" title="View HTML">§</a></h3>

<p>See <a class="reference internal" href="#rose:conf:rose_arch[arch]rename-parser" title="rose:conf:rose_arch[arch]rename-parser"><code class="xref rose rose-conf docutils literal notranslate"><span class="pre">rose_arch[arch]rename-parser</span></code></a>.</p>
<p>This allows you to parse the the name you give in <a class="reference internal" href="#rose:conf:rose_arch[arch]source" title="rose:conf:rose_arch[arch]source"><code class="xref rose rose-conf docutils literal notranslate"><span class="pre">rose_arch[arch]source</span></code></a> using
regular expressions for use in <code class="docutils literal notranslate"><span class="pre">rename-format</span></code>.</p>
<p>This is handy if you set a path to <a class="reference internal" href="#rose:conf:rose_arch[arch]source" title="rose:conf:rose_arch[arch]source"><code class="xref rose rose-conf docutils literal notranslate"><span class="pre">rose_arch[arch]source</span></code></a> but want the target
to just be a name - imagine a case where you wanted to collect a group of files
with names in the form <code class="docutils literal notranslate"><span class="pre">data_001.txt</span></code>:</p>
<div class="highlight-rose notranslate"><div class="highlight"><pre><span></span><span class="nt">[arch:Target]</span>
<span class="nv">source</span><span class="o">=</span><span class="s">/some/path/data*.txt</span>
<span class="nv">rename-parser</span><span class="o">=</span><span class="s">^//some//path//data_(?P&lt;serial_number&gt;[0-9]{3})(?P&lt;name_tail&gt;.*)$</span>
<span class="nv">rename-format</span><span class="o">=</span><span class="s">hello/%(cycle)s-%(name_head)s%(name_tail)s</span>
</pre></div>
</div>




</article>
<article class="slide level-2" id="output">

<h2>Output<a class="headerlink" href="../../../html/api/built-in/rose_arch.html#output" title="View HTML">§</a></h2>

<p>On completion, <a class="reference internal" href="#rose:app:rose_arch" title="rose:app:rose_arch"><code class="xref rose rose-app docutils literal notranslate"><span class="pre">rose_arch</span></code></a> writes a status summary for each
target to the standard output, which looks like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>0 foo:///fred/my-su173/output0.tar.gz [compress=tar.gz]
+ foo:///fred/my-su173/output1.tar.gz [compress=tar.gz, t(init)=2012-12-02T20:02:20Z, dt(tran)=5s, dt(arch)=10s, ret-code=0]
+       output1/earth.txt (output1/human.txt)
+       output1/venus.txt (output1/woman.txt)
+       output1/mars.txt (output1/man.txt)
= foo:///fred/my-su173/output2.tar.gz [compress=tar.gz]
! foo:///fred/my-su173/output3.tar.gz [compress=tar.gz]
</pre></div>
</div>
<p>The first column is a status symbol, where:</p>
<dl class="docutils">
<dt>0</dt><dd>An optional target has no real source, and is skipped.</dd>
<dt>+</dt><dd>A target is added or updated.</dd>
<dt>=</dt><dd>A target is not updated, as it was previously successfully updated with
the same sources.</dd>
<dt>!</dt><dd>Error updating this target.</dd>
</dl>
<p>If the first column and the second column are separated by a space character,
the second column is a target. If the first column and the second column are
separated by a tab character, the second column is a source in the target
above.</p>
<p>For a target line, the third column contains the compress scheme, the
initial time, the duration taken to transform the sources, the duration
taken to run the archive command and the return code of the archive
command. For a source line, the third column contains the original name of
the source.</p>




</article>
<article class="slide level-2" id="configuration">

<h2>Configuration<a class="headerlink" href="../../../html/api/built-in/rose_arch.html#configuration" title="View HTML">§</a></h2>

<dl class="rose app">
<dt id="rose:app:rose_arch">
<em class="property">Rose App </em><code class="descname">rose_arch</code></dt>
<dd><dl class="rose conf">
<dt id="rose:conf:rose_arch[arch]">
<em class="property">Config </em><code class="descname">[arch]</code><em class="property">(alternate: arch:TARGET)</em></dt>
<dd><dl class="rose conf">
<dt id="rose:conf:rose_arch[arch]command-format">
<em class="property">Config </em><code class="descname">command-format</code><em class="property">= FORMAT</em></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Compulsory:</th><td class="field-body">True</td>
</tr>
</tbody>
</table>
<p>A Pythonic <code class="docutils literal notranslate"><span class="pre">printf</span></code>-style format string to construct the archive
command. It must contain the placeholders <code class="docutils literal notranslate"><span class="pre">%(sources)s</span></code>
and <code class="docutils literal notranslate"><span class="pre">%(target)s</span></code> for substitution of the sources and the target
respectively.</p>
</dd></dl>

<dl class="rose conf">
<dt id="rose:conf:rose_arch[arch]compress">
<em class="property">Config </em><code class="descname">compress</code><em class="property">= pax|tar|pax.gz|tar.gz|tgz|gz</em></dt>
<dd><p>If specified, compress source files scheme before sending them to the
archive. If not set Rose Arch will attempt to set a compression scheme
if the file extension of the target implies compression: For
example, setting target as <code class="docutils literal notranslate"><span class="pre">[arch:example.tar]</span></code> is the same as
setting <code class="docutils literal notranslate"><span class="pre">compress=tar</span></code>.</p>
<p>Each compression scheme works slightly differently:</p>
<table border="1" class="docutils align-default">
<colgroup>
<col width="28%" />
<col width="72%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Compression Scheme</td>
<td>Behaviour</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">pax</span></code> or <code class="docutils literal notranslate"><span class="pre">tar</span></code></td>
<td>Sources will be placed in a TAR archive before
being sent to the target.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">pax.gz</span></code>,
<code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> or
<code class="docutils literal notranslate"><span class="pre">tgz</span></code></td>
<td>Sources will be placed in a TAR-GZIP file
before being sent to the target.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">gz</span></code></td>
<td>Each source file will be compressed by GZIP
before being sent to the target.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="rose conf">
<dt id="rose:conf:rose_arch[arch]rename-format">
<em class="property">Config </em><code class="descname">rename-format</code></dt>
<dd><p>If specified, the source files will be renamed according to the
specified format. The format string should be a Pythonic
<code class="docutils literal notranslate"><span class="pre">printf</span></code>-style format string.</p>
<p>By default the following variables are available:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">%(cycle)s</span></code> for the current <span class="target" id="index-0"></span><a class="reference internal" href="../environment-variables.html#envvar-ROSE_TASK_CYCLE_TIME"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ROSE_TASK_CYCLE_TIME</span></code></a></li>
<li><code class="docutils literal notranslate"><span class="pre">%(name)s</span></code> for the file or path set in <a class="reference internal" href="#rose:conf:rose_arch[arch]source" title="rose:conf:rose_arch[arch]source"><code class="xref rose rose-conf docutils literal notranslate"><span class="pre">source</span></code></a></li>
</ul>
<p>You may also use <a class="reference internal" href="#rose:conf:rose_arch[arch]rename-parser" title="rose:conf:rose_arch[arch]rename-parser"><code class="xref rose rose-conf docutils literal notranslate"><span class="pre">rename-parser</span></code></a> to generate further fields
from the input name.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">As <code class="docutils literal notranslate"><span class="pre">%(name)s</span></code> can be a path, so that
if <code class="docutils literal notranslate"><span class="pre">rename-format=&quot;%(cycle)s_%(name)s&quot;</span></code> you can have destination
paths such <code class="docutils literal notranslate"><span class="pre">02_path/to/some.file</span></code>, which are unlikely to work. If
you want to manipulate your source name in such cases
should use <a class="reference internal" href="#rose:conf:rose_arch[arch]rename-parser" title="rose:conf:rose_arch[arch]rename-parser"><code class="xref rose rose-conf docutils literal notranslate"><span class="pre">rename-parser</span></code></a>.</p>
</div>
</dd></dl>

<dl class="rose conf">
<dt id="rose:conf:rose_arch[arch]rename-parser">
<em class="property">Config </em><code class="descname">rename-parser</code></dt>
<dd><p>Ignored if <a class="reference internal" href="#rose:conf:rose_arch[arch]rename-format" title="rose:conf:rose_arch[arch]rename-format"><code class="xref rose rose-conf docutils literal notranslate"><span class="pre">rename-format</span></code></a> is not specified.</p>
<p>Specify a regular expression to parse the name provided by <a class="reference internal" href="#rose:conf:rose_arch[arch]source" title="rose:conf:rose_arch[arch]source"><code class="xref rose rose-conf docutils literal notranslate"><span class="pre">source</span></code></a>,
using the Python regex syntax <code class="docutils literal notranslate"><span class="pre">(?P&lt;label&gt;what</span> <span class="pre">you</span> <span class="pre">want</span> <span class="pre">to</span> <span class="pre">capture)</span></code></p>
<p>For example, a regular expression in the form:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">^\/home\/data\/(?P&lt;filename&gt;myfile)(?P&lt;serialnumber&gt;[0-9]{3}).someExtension$</span>
</pre></div>
</div>
<p>Will label the captured section using with the contents of <code class="docutils literal notranslate"><span class="pre">&lt;&gt;</span></code>.
In this example you would then have <code class="docutils literal notranslate"><span class="pre">%(filename)s</span></code> and
<code class="docutils literal notranslate"><span class="pre">%(serialnumber)</span></code> to use in your <a class="reference internal" href="#rose:conf:rose_arch[arch]rename-format" title="rose:conf:rose_arch[arch]rename-format"><code class="xref rose rose-conf docutils literal notranslate"><span class="pre">rename-format</span></code></a> string.</p>
</dd></dl>

<dl class="rose conf">
<dt id="rose:conf:rose_arch[arch]source">
<em class="property">Config </em><code class="descname">source</code><em class="property">= NAME</em></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Compulsory:</th><td class="field-body">True</td>
</tr>
</tbody>
</table>
<p>Specify a list of source file names and/or globs
for matching source file names. List items are separated by spaces.</p>
<ul class="simple">
<li>File names with space or quote  characters can be escaped using quotes
or backslashes, like in a shell.)</li>
<li>Paths, if not absolute (beginning with a <code class="docutils literal notranslate"><span class="pre">/</span></code>), are
assumed to be relative to <span class="target" id="index-1"></span><a class="reference internal" href="../environment-variables.html#envvar-ROSE_SUITE_DIR"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ROSE_SUITE_DIR</span></code></a> or to
<code class="docutils literal notranslate"><span class="pre">$ROSE_SUITE_DIR/PREFIX</span></code> if <a class="reference internal" href="#rose:conf:rose_arch[arch]source-prefix" title="rose:conf:rose_arch[arch]source-prefix"><code class="xref rose rose-conf docutils literal notranslate"><span class="pre">source-prefix</span></code></a> is specified.</li>
<li>If a name or glob is given in a pair of brackets,
e.g.``(hello-world.*)``, the source is considered optional and will
not cause a failure if it does not match any source file names.</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If a target does not have <code class="docutils literal notranslate"><span class="pre">()</span></code> around it then is it compulsory
and if no matching source is found then the archiving of that file
will be considered a failure.</p>
</div>
</dd></dl>

<dl class="rose conf">
<dt id="rose:conf:rose_arch[arch]source-edit-format">
<em class="property">Config </em><code class="descname">source-edit-format</code><em class="property">= FORMAT</em></dt>
<dd><p>Construct a command to edit or modify the content of source files
before archiving them. It uses a Pythonic <code class="docutils literal notranslate"><span class="pre">printf</span></code>-style format
string to describe inputs and outputs.</p>
<p>It must contain the placeholders <code class="docutils literal notranslate"><span class="pre">%(in)s</span></code> and <code class="docutils literal notranslate"><span class="pre">%(out)s</span></code> for
substitution of the path to the source file and the path to the
modified source file (which will be created in a temporary working
directory).</p>
<p>For example you might wish to replace the word “Hello” with “Greet”
using sed:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>source-edit-format<span class="o">=</span>sed <span class="s1">&#39;s/Hello/Greet/g&#39;</span> %<span class="o">(</span><span class="k">in</span><span class="o">)</span>s &gt;%<span class="o">(</span>out<span class="o">)</span>s
</pre></div>
</div>
</dd></dl>

<dl class="rose conf">
<dt id="rose:conf:rose_arch[arch]source-prefix">
<em class="property">Config </em><code class="descname">source-prefix</code><em class="property">= PREFIX</em></dt>
<dd><p>Add a prefix to each value in a source declaration. A trailing
slash should be added for a directory. Paths are assumed to be
relative to <span class="target" id="index-2"></span><a class="reference internal" href="../environment-variables.html#envvar-ROSE_SUITE_DIR"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ROSE_SUITE_DIR</span></code></a>. This setting serves two
purposes:</p>
<ul class="simple">
<li>It provides a way to avoid typing the name of the source directory
repeatedly.</li>
<li>If you are using <a class="reference internal" href="#rose:conf:rose_arch[arch]rename-format" title="rose:conf:rose_arch[arch]rename-format"><code class="xref rose rose-conf docutils literal notranslate"><span class="pre">rename-format</span></code></a> or if the target is
a compressed file your target’s <code class="docutils literal notranslate"><span class="pre">%(name)s</span></code> will be the entirety
of what you set in <a class="reference internal" href="#rose:conf:rose_arch[arch]source" title="rose:conf:rose_arch[arch]source"><code class="xref rose rose-conf docutils literal notranslate"><span class="pre">source</span></code></a>, so you may wish to avoid
this being a full path.</li>
</ul>
</dd></dl>

<dl class="rose conf">
<dt id="rose:conf:rose_arch[arch]target-prefix">
<em class="property">Config </em><code class="descname">target-prefix</code><em class="property">= PREFIX</em></dt>
<dd><p>Add a prefix to each target declaration. This setting provides
a way to avoid typing the same thing repeatedly. A trailing
slash (or whatever is relevant for the archiving system) should
be added for a directory.</p>
</dd></dl>

<dl class="rose conf">
<dt id="rose:conf:rose_arch[arch]update-check">
<em class="property">Config </em><code class="descname">update-check</code><em class="property">= mtime+size|md5|sha1|...</em></dt>
<dd><p>Specify the method for checking whether a source has changed
since the previous run. If the value is mtime+size, the
application will use the modified time and size of the source,
which is useful for large files, but is less correct. Otherwise,
the value, if specified, should be the name of a hash object in
Python’s <a class="reference external" href="https://docs.python.org/3/library/hashlib.html">hashlib</a>, such as <code class="docutils literal notranslate"><span class="pre">md5</span></code> (default), <code class="docutils literal notranslate"><span class="pre">sha1</span></code>, etc.
In this mode, the application will use the checksum (based on
the specified hashing method) of the content of each source file
to determine if it has changed or not.</p>
</dd></dl>

</dd></dl>

</dd></dl>





</article>

</section>

<section id="slide_notes">

</section>

  </body>
</html>